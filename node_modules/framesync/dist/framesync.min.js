!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).framesync={})}(this,function(e){"use strict";var n=1/60*1e3,t="undefined"!=typeof window?function(e){return window.requestAnimationFrame(e)}:function(e){return setTimeout(function(){return e(performance.now())},n)};function r(e){return f[e].process(i)}var u=!0,s=!1,o=!1,i={delta:0,timestamp:0},c=["read","update","preRender","render","postRender"],f=c.reduce(function(e,n){var u,o,i,c,f,a,d;return e[n]=(u=function(){return s=!0},o=[],c=0,f=!(i=[]),a=new WeakSet,d={schedule:function(e,n,t){void 0===n&&(n=!1),void 0===t&&(t=!1);var r=t&&f,t=r?o:i;return n&&a.add(e),-1===t.indexOf(e)&&(t.push(e),r&&f&&(c=o.length)),e},cancel:function(e){var n=i.indexOf(e);-1!==n&&i.splice(n,1),a.delete(e)},process:function(e){var n;if(f=!0,o=(n=[i,o])[0],(i=n[1]).length=0,c=o.length)for(var t=0;t<c;t++){var r=o[t];r(e),a.has(r)&&(d.schedule(r),u())}f=!1}}),e},{}),a=c.reduce(function(e,n){var r=f[n];return e[n]=function(e,n,t){return void 0===n&&(n=!1),void 0===t&&(t=!1),s||l(),r.schedule(e,n,t)},e},{}),d=c.reduce(function(e,n){return e[n]=f[n].cancel,e},{}),p=function(e){s=!1,i.delta=u?n:Math.max(Math.min(e-i.timestamp,40),1),i.timestamp=e,o=!0,c.forEach(r),o=!1,s&&(u=!1,t(p))},l=function(){u=s=!0,o||t(p)};e.cancelSync=d,e.default=a,e.getFrameData=function(){return i},Object.defineProperty(e,"__esModule",{value:!0})});
